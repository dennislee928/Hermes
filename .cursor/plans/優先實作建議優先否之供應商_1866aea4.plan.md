---
name: 優先實作建議優先否之供應商
overview: 依據 Hermes 資安整合服務計畫與 indo_src.txt 供應商清單，將實作優先順序改為「建議優先＝否」的供應商優先；並對照目前程式碼狀態，列出具體實作項目與步驟。
todos: []
isProject: false
---

# 優先實作「建議優先＝否」供應商 — 實作計畫

## 1. 需求與現狀對照

計畫文件 [.cursor/plans/hermes_資安整合服務_063bfe3b.plan.md](.cursor/plans/hermes_資安整合服務_063bfe3b.plan.md) 第 3 節供應商清單中，「建議優先」欄為**否**的供應商如下，本計畫建議**優先為這些供應商實作 adapter**（其餘「建議優先＝是」者已部分實作或可延後）。


| 分類                  | 供應商                       | 說明                 | 目前程式碼狀態                     |
| ------------------- | ------------------------- | ------------------ | --------------------------- |
| Threat Intelligence | BinaryEdge.io             | IP/網域/漏洞掃描         | Config 已有 key，**無 adapter** |
|                     | EmailRep                  | 信箱名譽               | 未實作                         |
|                     | Pulsedive                 | IOC 情資             | 未實作                         |
|                     | ThreatMiner               | 網域/IP/惡意程式情資       | 未實作                         |
| Domain/URL Security | CriminalIP.io             | IP/網域情資            | Config 已有 key，**無 adapter** |
|                     | IP ASN History (D4/CIRCL) | IP ASN 歷史          | 未實作（與現有 CIRCL CVE 不同服務）     |
| CVE / 漏洞            | Vulners                   | 漏洞/修補              | 未實作                         |
| Malware / Sandbox   | Hybrid Analysis           | 沙箱                 | 未實作                         |
|                     | Malshare                  | 惡意樣本               | 未實作                         |
|                     | MalwareBazaar (abuse.ch)  | 惡意樣本               | 未實作                         |
| 其他                  | SSL Labs                  | SSL 評等             | 未實作                         |
| 選用（商業）              | SOCRadar 系列               | 以 env 開關，無 key 則略過 | 未實作                         |


**目前已實作**（多為「建議優先＝是」）：AbuseIPDB、VirusTotal、PhishTank、urlscan.io、HIBP、NVD、CIRCL CVE Search。  
實作模式：`internal/provider/{code}/client.go` 實作 [providerapi.Adapter](internal/providerapi/adapter.go)，並在 [registry.NewRegistry](internal/registry/registry.go) 註冊；API key 自 [config.Config](internal/config/config.go) 讀取，key 為空時回傳「未設定」或略過。

---

## 2. 實作優先順序建議（「否」者分批）

- **第一批（Config 已有或 API 常見、易整合）**  
  - BinaryEdge、CriminalIP（config 已有欄位，補 adapter + registry 即可）  
  - Pulsedive、ThreatMiner（IOC/情資，與現有 ip/domain/url 類型一致）
- **第二批（需新增 Config + .env.example）**  
  - EmailRep（email 名譽）、Vulners（CVE）、IP ASN History（CIRCL 另一服務）
- **第三批（Malware / 其他）**  
  - Hybrid Analysis、Malshare、MalwareBazaar、SSL Labs
- **選用**  
  - SOCRadar：以 env 開關、無 key 則不註冊，可最後或依需求再做。

同一批內可並行開發，每支 adapter 獨立一個資料夾、不共用狀態。

---

## 3. 每個新供應商需動到的檔案（清單）

- **新增**  
  - `internal/provider/{code}/client.go`：實作 `providerapi.Adapter`（`Code()`、`SupportedTypes()`、`Lookup(ctx, indicatorType, value)`）；key 為空時回傳 `Success: false, Error: "not configured"`，不中斷統一查詢。
- **修改**  
  - [internal/config/config.go](internal/config/config.go)：新增對應 `XxxAPIKey`（或 `XxxBaseURL`），自環境變數讀取。  
  - [internal/registry/registry.go](internal/registry/registry.go)：import 新 provider、在 `adapters` 中加入 `xxx.NewClient(cfg.XxxAPIKey)`。  
  - [.env.example](.env.example)：新增 `{PROVIDER}_API_KEY=` 等變數說明。
- **可選**  
  - 若該供應商有獨立 rate limit，可在 `providers` 表或 config 中預留欄位；第一版可先不寫入 DB，與現有架構一致即可。

不需改動 handler/service 介面；統一 lookup 與單一 provider 端點會自動帶入新 adapter。

---

## 4. 計畫文件建議更新（可選）

- 在 [.cursor/plans/hermes_資安整合服務_063bfe3b.plan.md](.cursor/plans/hermes_資安整合服務_063bfe3b.plan.md) 第 3 節表格後加一段說明：  
「實作順序：本階段**優先實作「建議優先＝否」**之供應商（BinaryEdge、EmailRep、Pulsedive、ThreatMiner、CriminalIP、IP ASN History、Vulners、Hybrid Analysis、Malshare、MalwareBazaar、SSL Labs、選用 SOCRadar）；『建議優先＝是』且尚未實作者（如 Google Safe Browsing、URLhaus）於其後補齊。」
- 或將第 7 節「實作順序建議」改為：先完成上述「否」清單的 adapter + config + registry + .env.example，再補「是」未實作與其他項目。

---

## 5. 小結

- **目標**：依 indo_src.txt 供應商清單與計畫表，**優先實作「建議優先＝否」**的供應商 adapter。  
- **做法**：沿用既有 `providerapi.Adapter` + `Registry` + Config 模式，每供應商一目錄、env key 空則略過。  
- **順序**：先 BinaryEdge / CriminalIP（已有 config）→ 再 Pulsedive / ThreatMiner / EmailRep / Vulners / IP ASN History → 再 Malware 系與 SSL Labs → 最後選用 SOCRadar。  
- **計畫檔**：可於原計畫第 3、7 節加註「本階段優先實作否者」，以與本實作順序一致。

