{
    "swagger": "2.0",
    "info": {
        "description": "Unified lookup and per-provider lookup for threat intelligence, CVE, and URL/domain security.",
        "title": "Hermes Cybersecurity Provider API",
        "contact": {},
        "version": "1.0"
    },
    "host": "localhost:8080",
    "basePath": "/api/v1",
    "paths": {
        "/lookup": {
            "post": {
                "description": "Run lookup across all providers that support the indicator type",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "lookup"
                ],
                "summary": "Unified lookup",
                "parameters": [
                    {
                        "description": "Lookup request",
                        "name": "body",
                        "in": "body",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/hermes_internal_dto.LookupRequestDTO"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/hermes_internal_vo.LookupResponseVO"
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "schema": {
                            "$ref": "#/definitions/hermes_internal_vo.ErrorVO"
                        }
                    },
                    "500": {
                        "description": "Internal Server Error",
                        "schema": {
                            "$ref": "#/definitions/hermes_internal_vo.ErrorVO"
                        }
                    }
                }
            }
        },
        "/providers/{code}/{type}/{value}": {
            "get": {
                "description": "Lookup using one provider by code (e.g. abuseipdb, virustotal)",
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "providers"
                ],
                "summary": "Single-provider lookup",
                "parameters": [
                    {
                        "type": "string",
                        "description": "Provider code (e.g. abuseipdb)",
                        "name": "code",
                        "in": "path",
                        "required": true
                    },
                    {
                        "type": "string",
                        "description": "Indicator type (ip, domain, url, hash, email)",
                        "name": "type",
                        "in": "path",
                        "required": true
                    },
                    {
                        "type": "string",
                        "description": "Indicator value",
                        "name": "value",
                        "in": "path",
                        "required": true
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/hermes_internal_vo.ProviderLookupResponseVO"
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "schema": {
                            "$ref": "#/definitions/hermes_internal_vo.ErrorVO"
                        }
                    },
                    "404": {
                        "description": "Not Found",
                        "schema": {
                            "$ref": "#/definitions/hermes_internal_vo.ErrorVO"
                        }
                    },
                    "500": {
                        "description": "Internal Server Error",
                        "schema": {
                            "$ref": "#/definitions/hermes_internal_vo.ProviderLookupResponseVO"
                        }
                    }
                }
            }
        }
    },
    "definitions": {
        "hermes_internal_dto.LookupRequestDTO": {
            "description": "Request body for unified lookup",
            "type": "object",
            "required": [
                "indicator_type",
                "indicator_value"
            ],
            "properties": {
                "indicator_type": {
                    "description": "IndicatorType is one of: ip, domain, url, hash, email",
                    "type": "string",
                    "enum": [
                        "ip",
                        "domain",
                        "url",
                        "hash",
                        "email"
                    ],
                    "example": "ip"
                },
                "indicator_value": {
                    "description": "IndicatorValue is the value to look up (e.g. IP, domain, URL, hash, email)",
                    "type": "string",
                    "example": "8.8.8.8"
                },
                "providers": {
                    "description": "Providers optionally limits which providers to query (empty = all enabled)",
                    "type": "array",
                    "items": {
                        "type": "string"
                    }
                }
            }
        },
        "hermes_internal_vo.ErrorVO": {
            "description": "Standard error response",
            "type": "object",
            "properties": {
                "code": {
                    "type": "string",
                    "example": "BAD_REQUEST"
                },
                "message": {
                    "type": "string",
                    "example": "invalid request"
                }
            }
        },
        "hermes_internal_vo.LookupResponseVO": {
            "description": "Response for unified lookup across providers",
            "type": "object",
            "properties": {
                "indicator_type": {
                    "type": "string",
                    "example": "ip"
                },
                "indicator_value": {
                    "type": "string",
                    "example": ""
                },
                "request_id": {
                    "type": "string",
                    "example": "550e8400-e29b-41d4-a716-446655440000"
                },
                "results": {
                    "type": "object",
                    "additionalProperties": {
                        "$ref": "#/definitions/hermes_internal_vo.ProviderResultVO"
                    }
                }
            }
        },
        "hermes_internal_vo.ProviderLookupResponseVO": {
            "type": "object",
            "properties": {
                "data": {},
                "error": {
                    "type": "string"
                },
                "provider_code": {
                    "type": "string"
                },
                "success": {
                    "type": "boolean"
                }
            }
        },
        "hermes_internal_vo.ProviderResultVO": {
            "description": "Single provider lookup result",
            "type": "object",
            "properties": {
                "data": {},
                "error": {
                    "type": "string"
                },
                "provider_code": {
                    "type": "string",
                    "example": "abuseipdb"
                },
                "success": {
                    "type": "boolean"
                }
            }
        }
    }
}